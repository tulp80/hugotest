{{ define "main" }}
  <section class="section" style="padding-top:5rem;">
    <div class="container">
      <a class="back-link" href="{{ relLangURL "/blog/" }}">← Back to blog</a>

      <header class="blog-post-header">
        <h1>{{ .Title }}</h1>
        <div class="blog-post-header__meta">
          <div>{{ .Date.Format "02 Jan 2006" }}</div>
          {{ with .Params.author }}<div>{{ . }}</div>{{ end }}
          {{ with .Params.category }}<div>{{ . }}</div>{{ end }}
        </div>
        {{ with .Params.tags }}
          <div class="tag-list">
            {{ range . }}
              {{ $tag := . }}
              <a class="tag" href="{{ (printf "/tags/%s/" ($tag | urlize)) | relLangURL }}">{{ $tag }}</a>
            {{ end }}
          </div>
        {{ end }}
      </header>

      {{ with .Params.image }}
        <div style="margin-bottom:3rem;">
          {{ partial "responsive-image.html" (dict "src" . "alt" $.Title "sizes" "(min-width: 960px) 960px, 92vw" "widths" (slice 480 720 960)) }}
        </div>
      {{ end }}

      <div class="markdown">
        {{ .Content }}
      </div>

      {{ $related := first 3 (where (where .Site.RegularPages "Section" "blog") "Permalink" "ne" .Permalink) }}
      {{ if gt (len $related) 0 }}
        <div class="related-posts">
          <h2>Related posts</h2>
          <div class="blog-grid">
            {{ range $related }}
              {{ $entry := . }}
              <article class="blog-card">
                {{ with $entry.Params.image }}
                  <div class="blog-card__media">{{ partial "responsive-image.html" (dict "src" . "alt" $entry.Title "sizes" "(min-width: 960px) 320px, 80vw" "widths" (slice 320 480 640)) }}</div>
                {{ end }}
                <div class="blog-card__body">
                  <div class="blog-card__meta">{{ $entry.Date.Format "02 Jan 2006" }}</div>
                  <h3 class="blog-card__title"><a href="{{ $entry.RelPermalink }}">{{ $entry.Title }}</a></h3>
                  {{ with $entry.Params.excerpt }}<p class="blog-card__excerpt">{{ . }}</p>{{ end }}
                  <a class="blog-card__link" href="{{ $entry.RelPermalink }}">Read more →</a>
                </div>
              </article>
            {{ end }}
          </div>
        </div>
      {{ end }}
    </div>
  </section>
{{ end }}
