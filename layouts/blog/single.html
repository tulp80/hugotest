{{ define "main" }}
  <section class="section" style="padding-top:5rem;">
    <div class="container">
      <a class="back-link" href="{{ relLangURL "/blog/" }}">← Back to blog</a>

      <header class="blog-post-header">
        <h1>{{ .Title }}</h1>
        <div class="blog-post-header__meta">
          <div>{{ .Date.Format "02 Jan 2006" }}</div>
          {{ with .Params.author }}<div>{{ . }}</div>{{ end }}
          {{ with .Params.category }}<div>{{ . }}</div>{{ end }}
        </div>
        {{ with .Params.tags }}
          <div class="tag-list">
            {{ range . }}
              {{ $tag := . }}
              <a class="tag" href="{{ (printf "/tags/%s/" ($tag | urlize)) | relLangURL }}">{{ $tag }}</a>
            {{ end }}
          </div>
        {{ end }}
      </header>

      {{ with .Params.image }}
        <div style="margin-bottom:3rem;">
          <img src="{{ . }}" alt="{{ $.Title }}" loading="lazy">
        </div>
      {{ end }}

      <div class="markdown">
        {{ .Content }}
      </div>

      {{ $related := first 3 (where (where .Site.RegularPages "Section" "blog") "Permalink" "ne" .Permalink) }}
      {{ if gt (len $related) 0 }}
        <div class="related-posts">
          <h2>Related posts</h2>
          <div class="blog-grid">
            {{ range $related }}
              <article class="blog-card">
                {{ with .Params.image }}
                  <div class="blog-card__media"><img src="{{ . }}" alt="{{ $.Title }}" loading="lazy"></div>
                {{ end }}
                <div class="blog-card__body">
                  <div class="blog-card__meta">{{ .Date.Format "02 Jan 2006" }}</div>
                  <h3 class="blog-card__title"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                  {{ with .Params.excerpt }}<p class="blog-card__excerpt">{{ . }}</p>{{ end }}
                  <a class="blog-card__link" href="{{ .RelPermalink }}">Read more →</a>
                </div>
              </article>
            {{ end }}
          </div>
        </div>
      {{ end }}
    </div>
  </section>
{{ end }}
